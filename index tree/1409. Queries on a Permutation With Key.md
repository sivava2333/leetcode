# 1. 原题链接
[1409. Queries on a Permutation With Key](https://leetcode.com/problems/queries-on-a-permutation-with-key/)

# 2. 思路

# 3. 代码
```
class Solution {
    public int[] processQueries(int[] queries, int m) {
        int index = queries.length + m;
        IndexTree it = new IndexTree(index);
        HashMap<Integer, Integer> map = new HashMap<>();
        int num = m;
        while (index > queries.length) {
            map.put(num--, index);
            it.add(index--, 1);
        }
        
        int[] res = new int[queries.length];
        for (int i = 0; i < queries.length; i++) {
            int pos = map.get(queries[i]);
            res[i] = it.query(pos) - 1;
            it.add(pos, -1);
            it.add(index, 1);
            map.put(queries[i], index--);
        }
        
        return res;
    }
    
    class IndexTree {
        public int size;
        public int[] it;
        
        public IndexTree(int n) {
            size = n + 1;
            it = new int[size];
        }
        
        public void add(int index, int count) {
            while (index < size) {
                it[index] += count;
                index += index & -index;
            }
        }
        
        public int query(int index) {
            int ret = 0;
            while (index > 0) {
                ret += it[index];
                index -= index & -index;
            }
            
            return ret;
        }
    }
}
```
